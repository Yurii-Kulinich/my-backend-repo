<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Great DOM Drill</title>
</head>

<body>
  <h1>My favorite franchises</h1>

  <ul>
    <li>The Lord of the Rings</li>
    <li>Harry Potter</li>
    <li>Final Destination</li>
    <li>Harry Potter</li>
    <li>Saw</li>
    <li>Fast and Furious</li>
    <li>Hellraiser</li>
    <li>Nightmare on Elm Street</li>
    <li>Friday the 13th</li>
    <li>Twilight</li>
    <li>Final Destination</li>
  </ul>
</body>

<script>


//global constant
const myList = document.querySelector('ul');
const childrenNodes = document.querySelector('ul').children;
let childrenNodesCopy = Array.from(childrenNodes);
let bodyElement = document.querySelector('body');

document.body.onload = addElement;

const fastFurous = 'Fast and Furious';

const shuffle = (array) => {
  let currentIndex = array.length,  randomIndex;
let fknFurious = array[0];
  // While there remain elements to shuffle.
  while (currentIndex != 0) {

    // Pick a remaining element.
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;

    // And swap it with the current element.

    const temp = document.querySelector(`li:nth-child(${randomIndex + 1})`);
    myList.append(temp);
   
  }
myList.prepend(fknFurious);
//   return array;
}

//eventListeners 

bodyElement.addEventListener('keyup', keyEvents) 

// functions

for (let index = 0; index < childrenNodes.length; index++) {
    const element = childrenNodes[index];
        
    if (element.innerText === fastFurous) {
        
        let fF = document.querySelector(`li:nth-child(${index + 1})`);
        element.classList.add('important');
        
        myList.prepend(fF);
    }
    element.addEventListener('click', alertFunct);         
    
}

function addElement() {
    console.log("executed");
    let newDiv = document.createElement('div');
    newDiv.classList.add('important-select');
    newDiv.innerHTML = '<select name="important-not" id="important-not"><option value="important">Important</option><option value="not-important" selected>Not important</option></select>'
    let tempBody = document.querySelector('body');
    let tempList = document.querySelector('ul');
    tempBody.insertBefore(newDiv, tempList);

    const tempCollectio = document.querySelector('ul').children;
    const optionSelectior = tempBody.querySelector(".important-select");
    // console.log(tempBody.querySelector(".important-select"))
    optionSelectior.addEventListener('change', (e) => {
        if(e.target.value === 'important') {
            for (const iterator of tempCollectio) {
                if(iterator.className !== 'important') iterator.style.visibility = 'hidden';
            }
        } else if(e.target.value === 'not-important') {
            for (const iterator of tempCollectio) {
                iterator.style.visibility = 'visible';
            }
        }
    })


}

function alertFunct() {
    if(this.innerText === fastFurous) alert("The most important franchise ever, the story of DOM(inic) Toretto's family. It's not about car, it's about family");
    else alert(this.innerText)
}

function removeDu() {
   for (let index = 0; index < childrenNodes.length -1; index++) {
    const element1 = childrenNodes[index];
    let toRemove;
    for (let index2 = index +1; index2 < childrenNodes.length; index2++) {
      
        const element2 = childrenNodes[index2];
        if (element1.innerText ===element2.innerText) {
        toRemove = document.querySelector(`li:nth-child(${index + 2})`)
        element2.style.display = 'none';
        
        }
    
    }  
   
    }   
}

function clone() {
    const cloneNode = document.querySelector('li:first-child').cloneNode(true);
    console.log(cloneNode);
    myList.appendChild(cloneNode)
}

function keyEvents(event) {
    if (event.code === 'KeyR') shuffle(childrenNodes);
    else if(event.code === 'KeyS') clone();
}
removeDu();
// addElement()

</script>

</html>